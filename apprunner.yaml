version: 1.0
runtime: python311

build:
  commands:
    build:
      - python3 -m pip install --no-cache-dir --upgrade pip setuptools wheel
      - python3 -m pip install --no-cache-dir --target /app/.pip-packages -r backend/requirements.txt

run:
  runtime-version: 3.11
  command: bash backend/start.sh
  network:
    port: 8000
    env: PORT
  env:
    - name: PYTHONUNBUFFERED
      value: "1"
    - name: PYTHONDONTWRITEBYTECODE
      value: "1"
    - name: DATABASE_URL
      value: "postgresql://postgres:ChatbotProvefut2025!@chatbot-provefut-db.cyfwq6kgermb.us-east-1.rds.amazonaws.com:5432/chatbot_provefut"
    - name: DJANGO_SECRET_KEY
      value: "provefut-chatbot-secret-key-2025"
    - name: DEBUG
      value: "False"
    - name: COGNITO_USER_POOL_ID
      value: "us-east-1_hERvQ0wWv"
    - name: COGNITO_REGION
      value: "us-east-1"
    - name: ALLOWED_HOSTS
      value: "*"
    - name: CORS_ALLOWED_ORIGINS
      value: "https://main.d2ar0ncsvlrfzm.amplifyapp.com,https://main.d36fklzw84e0tr.amplifyapp.com,http://localhost:8080"
